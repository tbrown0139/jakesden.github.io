<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><title>FFmpeg-3.2.2</title><link rel="stylesheet" href="stylesheets/lfs.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="stylesheet" href="../stylesheets/lfs-print.css" type="text/css" media="print" /></head><body class="blfs" id="blfs-2017-01-20"><div class="navheader"><h4>Beyond Linux<sup>®</sup> From Scratch - Version 2017-01-20</h4><h3>Chapter 1. Installing packages in dependency build order</h3><ul><li class="prev"><a accesskey="p" href="sdl2.html" title="SDL2-2.0.5">Prev</a><p>SDL2-2.0.5</p></li><li class="next"><a accesskey="n" href="libassuan.html" title="libassuan-2.4.3">Next</a><p>libassuan-2.4.3</p></li><li class="up"><a accesskey="u" href="ch01.html" title="Chapter 1. Installing packages in dependency build order">Up</a></li><li class="home"><a accesskey="h" href="index.html" title="Beyond Linux® From Scratch - Version 2017-01-20">Home</a></li></ul></div><div class="sect1" lang="en" xml:lang="en"><h1 class="sect1"><a id="ffmpeg" name="ffmpeg"></a>FFmpeg-3.2.2</h1><div class="package" lang="en" xml:lang="en"><h2 class="sect2">Introduction to FFmpeg</h2><p>
      <span class="application">FFmpeg</span> is a solution to record, convert and
      stream audio and video. It is a very fast video and audio converter and it
      can also acquire from a live audio/video source. Designed to be intuitive,
      the command-line interface (<span class="command"><strong>ffmpeg</strong></span>) tries to figure out
      all the parameters, when possible. <span class="application">FFmpeg</span> can
      also convert from any sample rate to any other, and resize video on the
      fly with a high quality polyphase filter.
      <span class="application">FFmpeg</span> can use a Video4Linux compatible video
      source and any Open Sound System audio source.
    </p><p>This package is known to build and work
                              properly using an LFS-7.10 platform.</p><h3>Package Information</h3><div class="itemizedlist"><ul class="compact"><li><p>
          Download (HTTP): <a class="ulink" href="http://ffmpeg.org/releases/ffmpeg-3.2.2.tar.xz">http://ffmpeg.org/releases/ffmpeg-3.2.2.tar.xz</a>
        </p></li><li></li><li><p>
          Download MD5 sum: e34d1b92c5d844f2a3611c741a6dba18
        </p></li><li><p>
          Download size: 7.6 MB
        </p></li><li><p>
          Estimated disk space required: 171 MB (add 2.9 GB for the FATE suite/tests
    and 1.0 GB for the documentation)
        </p></li><li><p>
          Estimated build time: 4.1 SBU (add 0.6 SBU for docs and 4.0 SBU
    to run the FATE suite after sample files are downloaded)
        </p></li></ul></div><h3>FFmpeg Dependencies</h3><h4>Recommended</h4><p class="recommended">
      <a class="xref" href="libass.html" title="libass-0.13.6">libass-0.13.6</a>,
      <a class="xref" href="fdk-aac.html" title="fdk-aac-0.1.5">fdk-aac-0.1.5</a>,
      <a class="xref" href="freetype2.html" title="FreeType-2.7.1">FreeType-2.7.1</a>,
      <a class="xref" href="lame.html" title="LAME-3.99.5">LAME-3.99.5</a>,
      <a class="xref" href="libtheora.html" title="libtheora-1.1.1">libtheora-1.1.1</a>,
      <a class="xref" href="libvorbis.html" title="libvorbis-1.3.5">libvorbis-1.3.5</a>,
      <a class="xref" href="libvpx.html" title="libvpx-1.6.1">libvpx-1.6.1</a>,
      <a class="xref" href="opus.html" title="Opus-1.1.3">Opus-1.1.3</a>,
      <a class="xref" href="x264.html" title="x264-20160827-2245">x264-20160827-2245</a>,
      <a class="xref" href="x265.html" title="x265-2.2">x265-2.2</a>, and
      <a class="xref" href="yasm.html" title="yasm-1.3.0">yasm-1.3.0</a>
    </p><h4>Recommended for desktop use</h4><p class="recommended">
      <a class="xref" href="alsa-lib.html" title="alsa-lib-1.1.3">alsa-lib-1.1.3</a>,
      <a class="xref" href="libva.html" title="libva-1.7.3">libva-1.7.3</a>,
      <a class="xref" href="libvdpau.html" title="libvdpau-1.1.1">libvdpau-1.1.1</a> (with the corresponding driver package), and
      <a class="xref" href="sdl2.html" title="SDL2-2.0.5">SDL2-2.0.5</a>,
    </p><h4>Optional</h4><p class="optional">
      <a class="xref" href="fontconfig.html" title="Fontconfig-2.12.1">Fontconfig-2.12.1</a>,
      frei0r (in full book)
              ,
      libcdio (in full book)
               (to identify and play CDs),
      <a class="xref" href="libwebp.html" title="libwebp-0.5.2">libwebp-0.5.2</a>,
      opencv (in full book)
              ,
      openjpeg (in full book)
              ,
      <a class="xref" href="openssl.html" title="OpenSSL-1.0.2j">OpenSSL-1.0.2j</a> or
      <a class="xref" href="gnutls.html" title="GnuTLS-3.5.8">GnuTLS-3.5.8</a>,
      <a class="xref" href="pulseaudio.html" title="PulseAudio-9.0">PulseAudio-9.0</a>,
      <a class="xref" href="speex.html" title="Speex-1.2rc2">Speex-1.2rc2</a>,
      texlive (in full book)
              
         (or tl-installer (in full book)
              ) for PDF and PS documentation,
      v4l-utils (in full book)
              ,
      xvid (in full book)
              ,
      x-window-system (in full book)
              ,
      <a class="ulink" href="http://www.speech.cs.cmu.edu/flite/">Flite</a>,
      <a class="ulink" href="http://www.quut.com/gsm/">GSM</a>,
      <a class="ulink" href="http://xhevc.com/en/hevc/decoder/download.jsp">HEVC/H.265</a>,
      
      <a class="ulink" href="http://tipok.org.ua/node/17">libaacplus</a>,
      <a class="ulink" href="http://www.videolan.org/developers/libbluray.html">libbluray</a>,
      <a class="ulink" href="http://caca.zoy.org/">libcaca</a>,
      <a class="ulink" href="http://www.celt-codec.org/">libcelt</a>,
      <a class="ulink" href="http://sourceforge.net/projects/libdc1394">libdc1394</a>,
      <a class="ulink" href="https://www.videolan.org/developers/libdca.html">libdca</a>,
      <a class="ulink" href="https://ieee1394.wiki.kernel.org/index.php/Libraries">libiec61883</a>,
      <a class="ulink" href="https://github.com/dekkers/libilbc">libilbc</a>,
      <a class="ulink" href="http://sourceforge.net/projects/modplug-xmms/">libmodplug</a>,
      <a class="ulink" href="https://github.com/Distrotech/libnut">libnut</a> (Git checkout),
      <a class="ulink" href="http://rtmpdump.mplayerhq.hu/">librtmp</a>,
      <a class="ulink" href="http://www.libssh.org/">libssh</a>,
      
      <a class="ulink" href="http://kcat.strangesoft.net/openal-releases/">OpenAL</a>,
      <a class="ulink" href="http://sourceforge.net/projects/opencore-amr">OpenCore AMR</a>,
      
      <a class="ulink" href="http://sourceforge.net/projects/schrodinger/">Schroedinger</a>,
      <a class="ulink" href="http://www.twolame.org/">TwoLAME</a>,
      <a class="ulink" href="http://sourceforge.net/projects/opencore-amr/files/vo-aacenc/">vo-aaenc</a>,
      <a class="ulink" href="http://sourceforge.net/projects/opencore-amr/files/vo-amrwbenc/">vo-amrwbenc</a>, and
      
      <a class="ulink" href="http://zapping.sourceforge.net/ZVBI/">ZVBI</a>
    </p><p class="usernotes">
      User Notes: <a class="ulink" href="http://wiki.linuxfromscratch.org/blfs/wiki/ffmpeg">http://wiki.linuxfromscratch.org/blfs/wiki/ffmpeg</a>
    </p></div><div class="installation" lang="en" xml:lang="en"><h2 class="sect2">Installation of FFmpeg</h2><p>
      Install <span class="application">FFmpeg</span> by running the following
      commands:
    </p><pre class="userinput"><kbd class="command">sed -i 's/-lflite"/-lflite -lasound"/' configure &amp;&amp;

./configure --prefix=/usr        \
            --enable-gpl         \
            --enable-version3    \
            --enable-nonfree     \
            --disable-static     \
            --enable-shared      \
            --disable-debug      \
            --enable-libass      \
            --enable-libfdk-aac  \
            --enable-libfreetype \
            --enable-libmp3lame  \
            --enable-libopus     \
            --enable-libtheora   \
            --enable-libvorbis   \
            --enable-libvpx      \
            --enable-libx264     \
            --enable-libx265     \
            --enable-x11grab     \
            --docdir=/usr/share/doc/ffmpeg-3.2.2 &amp;&amp;

make &amp;&amp;

gcc tools/qt-faststart.c -o tools/qt-faststart</kbd></pre><p>
      HTML documentation was built in the previous step. If  you have
      texlive (in full book)
               installed and wish to build PDF and
      Postscript versions of the documentation, issue the following commands:
    </p><pre class="userinput"><kbd class="command">pushd doc &amp;&amp;
for DOCNAME in `basename -s .html *.html`
do
    texi2pdf -b $DOCNAME.texi &amp;&amp;
    texi2dvi -b $DOCNAME.texi &amp;&amp;

    dvips    -o $DOCNAME.ps   \
                $DOCNAME.dvi
done &amp;&amp;
popd &amp;&amp;
unset DOCNAME</kbd></pre><p>
      If you have <a class="xref" href="doxygen.html" title="Doxygen-1.8.13">Doxygen-1.8.13</a> installed and wish to create the API
      documentation (takes about 500 MB space), issue the command
      <span class="command"><strong>doxygen doc/Doxyfile</strong></span>.
    </p><p>
      The fate-suite tests include comparisons with installed files, and should
      not be run before the package is installed. Therefore, if you desire to
      run them, instructions are given further below.
    </p><p>
      Now, as the <code class="systemitem">root</code> user:
    </p><pre class="root"><kbd class="command">make install &amp;&amp;

install -v -m755    tools/qt-faststart /usr/bin &amp;&amp;
install -v -m644    doc/*.txt \
                    /usr/share/doc/ffmpeg-3.2.2</kbd></pre><p>
      If PDF and Postscript documentations were built, issue the following
      commands, as the <code class="systemitem">root</code> user, to
      install them:
    </p><pre class="root"><kbd class="command">install -v -m644 doc/*.pdf \
                 /usr/share/doc/ffmpeg-3.2.2 &amp;&amp;
install -v -m644 doc/*.ps  \
                 /usr/share/doc/ffmpeg-3.2.2</kbd></pre><p>
      If you used <span class="command"><strong>doxygen</strong></span> to create the API documentation,
      install it (another 500 MB of space) by issuing the following commands
      as the <code class="systemitem">root</code> user:
    </p><pre class="root"><kbd class="command">install -v -m755 -d /usr/share/doc/ffmpeg-3.2.2/api                     &amp;&amp;
cp -vr doc/doxy/html/* /usr/share/doc/ffmpeg-3.2.2/api                  &amp;&amp;
find /usr/share/doc/ffmpeg-3.2.2/api -type f -exec chmod -c 0644 \{} \; &amp;&amp;
find /usr/share/doc/ffmpeg-3.2.2/api -type d -exec chmod -c 0755 \{} \;</kbd></pre><p>
      To properly test the installation you must have rsync (in full book)
              
      installed and follow the instructions for the <a class="ulink" href="http://www.ffmpeg.org/fate.html"> FFmpeg Automated Testing
      Environment</a> (FATE). First, about 1 GB of sample files used to
      run FATE are downloaded with the command:
    </p><pre class="userinput"><kbd class="command">make fate-rsync SAMPLES=fate-suite/</kbd></pre><p>
      The <code class="filename">fate-suite</code> directory is
      created and the files are downloaded there. That command actually runs an
      rsync command, to obtain the sample files.  You may want to compress and
      keep this directory for testing again, in another system, or when a new
      version of ffmpeg is launched. Then, you unpack the sample files in the
      source directory, and run, again, the <span class="command"><strong>make fate-rsync
      ...</strong></span> command above, to sync with the repository. Now, the
      download size and time are drastically reduced.  Estimated values in
      "Package Information" do not include the download SBU. Some samples may
      have been removed, in the new version, so, in order to be sure local and
      server fate samples are identical, when you use previously saved samples,
      run the following command:
    </p><pre class="userinput"><kbd class="command"><span class="command"><strong>rsync -vrltLW  --delete --timeout=60 --contimeout=60 \
      rsync://fate-suite.ffmpeg.org/fate-suite/ fate-suite/</strong></span></kbd></pre><p>
      Next, FATE is executed, with the commands (you obtain a number of tests
      larger than 3000):
    </p><pre class="userinput"><kbd class="command">make fate THREADS=<em class="replaceable"><code>N</code></em> SAMPLES=fate-suite/ | tee ../fate.log &amp;&amp;
grep ^TEST ../fate.log | wc -l</kbd></pre><p>
      where <em class="replaceable"><code>N</code></em> is an integer,
      <em class="replaceable"><code>N</code></em> &#8804; number of cores in the system.
    </p></div><div class="commands" lang="en" xml:lang="en"><h2 class="sect2">Command Explanations</h2><p>
      <span class="command"><strong>sed -i ... configure</strong></span>: This command adds the
      <span class="application">ALSA</span> library to the
      <span class="application">Flite</span> <code class="envar">LDFLAGS</code> variable and
      enables the discovery of <span class="application">Flite</span>.
    </p><p>
      <span class="command"><strong>find ... ;</strong></span>: Fix permissions of documentation files
      and directories.
    </p><p>
      <em class="parameter"><code>--enable-libfreetype</code></em>: Enables
      <span class="application">Freetype</span> support.
    </p><p>
      <em class="parameter"><code>--enable-gpl</code></em>: Enables the use of GPL code and
      permits support for postprocessing, swscale and many other features.
    </p><p>
      <em class="parameter"><code>--enable-version3</code></em>: Enables the use of (L)GPL
      version 3 code.
    </p><p>
      <em class="parameter"><code>--enable-nonfree</code></em>: Enables the use of nonfree code.
      Note that the resulting libraries and binaries will be unredistributable.
    </p><p>
      <em class="parameter"><code>--disable-static</code></em>: This switch prevents
      installation of static versions of the libraries.
    </p><p>
      <em class="parameter"><code>--enable-shared</code></em>: Enables building shared
      libraries, otherwise only static libraries are built and installed.
    </p><p>
      <em class="parameter"><code>--disable-debug</code></em>: Disables building debugging
      symbols into the programs and libraries.
    </p><p>
      <em class="parameter"><code>--enable-libass</code></em>: Enables ASS/SSA subtitle format
      rendering via <code class="filename">libass</code>.
    </p><p>
      <em class="parameter"><code>--enable-libfdk-aac</code></em>: Enables currently the
      highest-quality AAC audio encoding via <code class="filename">libfdk-aac</code>.
    </p><p>
      <em class="parameter"><code>--enable-libmp3lame</code></em>: Enables MP3 audio encoding
      via <code class="filename">libmp3lame</code>.
    </p><p>
      <em class="parameter"><code>--enable-libvorbis --enable-libtheora</code></em>: Enables
      Theora video encoding via <code class="filename">libvorbis</code> and <code class="filename">libtheora</code>.
    </p><p>
      <em class="parameter"><code>--enable-libvorbis --enable-libvpx</code></em>: Enables WebM
      encoding via <code class="filename">libvorbis</code> and
      <code class="filename">libvpx</code>.
    </p><p>
      <em class="parameter"><code>--enable-libx264</code></em>: Enables high-quality
      H.264/MPEG-4 AVC encoding via <code class="filename">libx264</code>.
    </p><p>
      <em class="parameter"><code>--enable-libx265</code></em>: Enables high-quality
      H.265/HEVC encoding via <code class="filename">libx265</code>.
    </p><p>
      <em class="parameter"><code>--enable-x11grab</code></em>: Enables X11 grabbing.
    </p><p>
      <code class="option">--enable-openssl</code> or <code class="option">--enable-gnutls</code>:
      Enables HTTPS protocol for network streams.
    </p><p>
      <span class="command"><strong>gcc tools/qt-faststart.c -o tools/qt-faststart</strong></span>: This
      builds the <span class="command"><strong>qt-faststart</strong></span> program which can modify
      QuickTime formatted movies (<code class="filename">.mov</code>
      or <code class="filename">.mp4</code>) so that the header
      information is located at the beginning of the file instead of the end.
      This allows the movie file to begin playing before the entire file has
      been downloaded.
    </p><div class="admon note"><img alt="[Note]" src="images/note.png" /><h3>Note</h3><p>
        Support for most of the dependency packages requires using options
        passed to the <span class="command"><strong>configure</strong></span> script. View the output
        from <span class="command"><strong>./configure --help</strong></span> for complete information
        about enabling dependency packages.
      </p></div></div><div class="configuration" lang="en" xml:lang="en"><h2 class="sect2">Configuring FFmpeg</h2><div class="sect3" lang="en" xml:lang="en"><h3 class="sect3"><a id="ffmpeg-config" name="ffmpeg-config"></a>Config Files</h3><p>
        <code class="filename">/etc/ffserver.conf</code> and
        <code class="filename">~/.ffmpeg/ffserver-config</code>
      </p><p>
        You'll find a sample <span class="command"><strong>ffserver</strong></span> configuration file at
        <code class="filename">doc/ffserver.conf</code> in the source tree.
      </p></div></div><div class="content" lang="en" xml:lang="en"><h2 class="sect2">Contents</h2><div class="segmentedlist"><div class="seglistitem"><div class="seg"><strong class="segtitle">Installed Programs: </strong><span class="segbody">
		ffmpeg, ffplay, ffprobe, ffserver, and qt-faststart
        </span></div><div class="seg"><strong class="segtitle">Installed Libraries: </strong><span class="segbody">
          libavcodec.so, libavdevice.so, libavfilter.so,
          libavformat.so, libavutil.so, libpostproc.so,
          libswresample.so, and libswscale.so
        </span></div><div class="seg"><strong class="segtitle">Installed Directories: </strong><span class="segbody">
          /usr/include/libav{codec,device,filter,format,util},
          /usr/include/libpostproc,
          /usr/include/libsw{resample,scale},
          /usr/share/doc/ffmpeg-3.2.2, and
          /usr/share/ffmpeg
        </span></div></div></div><div class="variablelist"><h3>Short Descriptions</h3><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><a id="ffmpeg-prog"></a><span class="term"><span class="command"><strong>ffmpeg</strong></span></span></p></td><td><p>
            is a command-line tool to convert video files, network streams and
            input from a TV card to several video formats.
          </p></td></tr><tr><td><p><a id="ffplay"></a><span class="term"><span class="command"><strong>ffplay</strong></span></span></p></td><td><p>
            is a very simple and portable media player using the
            <code class="filename">ffmpeg</code> libraries and the SDL library.
          </p></td></tr><tr><td><p><a id="ffprobe"></a><span class="term"><span class="command"><strong>ffprobe</strong></span></span></p></td><td><p>
            gathers information from multimedia streams and prints it in a human
            and machine-readable fashion.
          </p></td></tr><tr><td><p><a id="ffserver"></a><span class="term"><span class="command"><strong>ffserver</strong></span></span></p></td><td><p>
            is a streaming server for everything that <span class="command"><strong>ffmpeg</strong></span>
            could use as input (files, streams, TV card input, webcam, etc).
          </p></td></tr><tr><td><p><a id="qt-faststart"></a><span class="term"><span class="command"><strong>qt-faststart</strong></span></span></p></td><td><p>
            moves the index file to the front of quicktime (mov/mp4) videos.
          </p></td></tr><tr><td><p><a id="libavcodec"></a><span class="term"><code class="filename">libavcodec.so</code></span></p></td><td><p>
            is a library containing the <span class="application">FFmpeg</span> codecs
            (both encoding and decoding).
          </p></td></tr><tr><td><p><a id="libavdevice"></a><span class="term"><code class="filename">libavdevice.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> device handling library.
          </p></td></tr><tr><td><p><a id="libavfilter"></a><span class="term"><code class="filename">libavfilter.so</code></span></p></td><td><p>
            is a library of filters that can alter video or audio between the
            decoder and the encoder (or output).
          </p></td></tr><tr><td><p><a id="libavformat"></a><span class="term"><code class="filename">libavformat.so</code></span></p></td><td><p>
            is a library containing the file formats handling (mux and demux
            code for several formats) used by <span class="command"><strong>ffplay</strong></span> as well
            as allowing the generation of  audio or video streams.
          </p></td></tr><tr><td><p><a id="libavutil"></a><span class="term"><code class="filename">libavutil.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> utility library.
          </p></td></tr><tr><td><p><a id="libpostproc"></a><span class="term"><code class="filename">libpostproc.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> post processing library.
          </p></td></tr><tr><td><p><a id="libswresample"></a><span class="term"><code class="filename">libswresample.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> audio rescaling library,
            it contains functions for converting audio sample formats.
          </p></td></tr><tr><td><p><a id="libswscale"></a><span class="term"><code class="filename">libswscale.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> image rescaling library.
          </p></td></tr></tbody></table></div></div><p class="updated">Last updated 
      on
       2016-12-14 17:19:36 +0000</p></div><div class="navfooter"><ul><li class="prev"><a accesskey="p" href="sdl2.html" title="SDL2-2.0.5">Prev</a><p>SDL2-2.0.5</p></li><li class="next"><a accesskey="n" href="libassuan.html" title="libassuan-2.4.3">Next</a><p>libassuan-2.4.3</p></li><li class="up"><a accesskey="u" href="ch01.html" title="Chapter 1. Installing packages in dependency build order">Up</a></li><li class="home"><a accesskey="h" href="index.html" title="Beyond Linux® From Scratch - Version 2017-01-20">Home</a></li></ul></div></body></html>